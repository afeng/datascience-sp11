<html>
  <head>
    <title>Scatterplot</title>
    <script src="/static/protovis-3.2/protovis-r3.2.js" type="text/javascript"></script>
    <script src="/static/jquery-1.5.1.min.js" type="text/javascript"></script>

  </head>
  <body><div id="center"><div id="fig">
    <script type="text/javascript+protovis">
        $(document).ready(function(){
            $.get("/data/toptags", function(data){
                data = $.parseJSON(data);
                data = data["data"]
                console.log(data);

                /* Sizing and scales. */
                var w = 3000,
                    h = 400,
                    x = pv.Scale.linear(0, 12*3 - 3).range(0, w),
                    y = pv.Scale.linear(0, 100).range(0, h),
                    c = pv.Scale.log(1, 100).range("orange", "brown");

                /* The root panel. */
                var vis = new pv.Panel()
                    .width(w)
                    .height(h)
                    .bottom(20)
                    .left(20)
                    .right(10)
                    .top(5);

                /* Y-axis and ticks. */
                vis.add(pv.Rule)
                    .data(y.ticks())
                    .bottom(y)
                    .strokeStyle(function(d) d ? "#eee" : "#000")
                  .anchor("left").add(pv.Label)
                    .visible(function(d) d > 0 && d < 1)
                    .text(y.tickFormat);

                /* X-axis and ticks. */
                vis.add(pv.Rule)
                    .data(x.ticks())
                    .left(x)
                    .strokeStyle(function(d) d ? "#eee" : "#000")
                  .anchor("bottom").add(pv.Label)
                    .visible(function(d) d > 0 && d < 100)
                    .text(x.tickFormat);

                /* The dot plot! */
                vis.add(pv.Panel)
                    .data(data)
                  .add(pv.Dot)
                    .left(function(d) x(d.month + (d.year-2008)*12 - 7 + 0.7*(Math.random() - Math.random())))
                    .bottom(function(d) y(d.count)/100)
                    .strokeStyle(pv.colors("#9c9ede", "#7375b5", "#4a5584", "#cedb9c", "#b5cf6b", "#8ca252", "#637939", "#e7cb94", "#e7ba52", "#bd9e39", "#8c6d31", "#e7969c", "#d6616b", "#ad494a", "#843c39", "#de9ed6", "#ce6dbd", "#a55194", "#7b4173").by(pv.index))
                    .fillStyle(function() this.strokeStyle().alpha(.2))
                    .size(function(d) d.count/100)
                    .title(function(d) d.count.toFixed(1));

                vis.render();
            });
        });

    </script>
  </div></div></body>
</html>
